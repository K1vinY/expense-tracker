<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åƒç´ è¨˜å¸³æœ¬ - æœ¬åœ°æ¸¬è©¦ç‰ˆ</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- æ¨™é¡Œå€åŸŸ -->
        <header class="header">
            <h1 class="title">ğŸ’° åƒç´ è¨˜å¸³æœ¬</h1>
            <div class="balance-display">
                <span class="balance-label">ç¸½é¤˜é¡:</span>
                <span class="balance-amount" id="totalBalance">$0</span>
            </div>
        </header>

        <!-- è¨˜å¸³è¡¨å–® -->
        <section class="form-section">
            <div class="form-container">
                <h2 class="section-title">ğŸ“ æ–°å¢è¨˜å¸³</h2>
                <form id="expenseForm" class="pixel-form">
                    <div class="form-group">
                        <label for="description">é …ç›®åç¨±:</label>
                        <input type="text" id="description" placeholder="ä¾‹å¦‚: åˆé¤" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="amount">é‡‘é¡:</label>
                        <input type="number" id="amount" placeholder="0" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="category">åˆ†é¡:</label>
                        <select id="category">
                            <option value="food">ğŸ” é¤é£²</option>
                            <option value="transport">ğŸš— äº¤é€š</option>
                            <option value="shopping">ğŸ›ï¸ è³¼ç‰©</option>
                            <option value="entertainment">ğŸ® å¨›æ¨‚</option>
                            <option value="bills">ğŸ’¡ å¸³å–®</option>
                            <option value="other">ğŸ“¦ å…¶ä»–</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="type">é¡å‹:</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="type" value="expense" checked>
                                <span class="radio-custom"></span>
                                æ”¯å‡º
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="type" value="income">
                                <span class="radio-custom"></span>
                                æ”¶å…¥
                            </label>
                        </div>
                    </div>
                    
                    <button type="submit" class="pixel-button primary">ğŸ’¾ å„²å­˜</button>
                </form>
            </div>
        </section>

        <!-- è¨˜å¸³åˆ—è¡¨ -->
        <section class="list-section">
            <div class="list-container">
                <h2 class="section-title">ğŸ“‹ è¨˜å¸³è¨˜éŒ„</h2>
                <div class="filter-controls">
                    <select id="categoryFilter" class="pixel-select">
                        <option value="">å…¨éƒ¨åˆ†é¡</option>
                        <option value="food">ğŸ” é¤é£²</option>
                        <option value="transport">ğŸš— äº¤é€š</option>
                        <option value="shopping">ğŸ›ï¸ è³¼ç‰©</option>
                        <option value="entertainment">ğŸ® å¨›æ¨‚</option>
                        <option value="bills">ğŸ’¡ å¸³å–®</option>
                        <option value="other">ğŸ“¦ å…¶ä»–</option>
                    </select>
                    <button id="clearAll" class="pixel-button danger">ğŸ—‘ï¸ æ¸…é™¤å…¨éƒ¨</button>
                </div>
                <div id="expenseList" class="expense-list">
                    <!-- è¨˜å¸³é …ç›®æœƒå‹•æ…‹æ’å…¥é€™è£¡ -->
                </div>
            </div>
        </section>

        <!-- çµ±è¨ˆå€åŸŸ -->
        <section class="stats-section">
            <div class="stats-container">
                <h2 class="section-title">ğŸ“Š çµ±è¨ˆè³‡è¨Š</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“ˆ</div>
                        <div class="stat-label">ç¸½æ”¶å…¥</div>
                        <div class="stat-value income" id="totalIncome">$0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“‰</div>
                        <div class="stat-label">ç¸½æ”¯å‡º</div>
                        <div class="stat-value expense" id="totalExpense">$0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“…</div>
                        <div class="stat-label">è¨˜éŒ„æ•¸</div>
                        <div class="stat-value" id="totalRecords">0</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // æœ¬åœ°ç‰ˆè¨˜å¸³æ‡‰ç”¨ï¼ˆä½¿ç”¨ LocalStorageï¼‰
        class ExpenseTracker {
            constructor() {
                this.expenses = JSON.parse(localStorage.getItem('expenses')) || [];
                this.init();
            }
            
            init() {
                this.renderExpenses();
                this.updateStats();
                this.bindEvents();
            }
            
            bindEvents() {
                document.getElementById('expenseForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addExpense();
                });
                
                document.getElementById('categoryFilter').addEventListener('change', () => {
                    this.filterExpenses();
                });
                
                document.getElementById('clearAll').addEventListener('click', () => {
                    this.clearAllExpenses();
                });
            }
            
            addExpense() {
                const description = document.getElementById('description').value;
                const amount = parseFloat(document.getElementById('amount').value);
                const category = document.getElementById('category').value;
                const type = document.querySelector('input[name="type"]:checked').value;
                
                if (!description || !amount) return;
                
                const expense = {
                    id: Date.now().toString(),
                    description,
                    amount: type === 'expense' ? -Math.abs(amount) : Math.abs(amount),
                    category,
                    type,
                    date: new Date().toISOString(),
                    timestamp: Date.now()
                };
                
                this.expenses.push(expense);
                this.saveExpenses();
                this.renderExpenses();
                this.updateStats();
                this.resetForm();
            }
            
            deleteExpense(id) {
                this.expenses = this.expenses.filter(expense => expense.id !== id);
                this.saveExpenses();
                this.renderExpenses();
                this.updateStats();
            }
            
            clearAllExpenses() {
                if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è¨˜å¸³è¨˜éŒ„å—ï¼Ÿ')) {
                    this.expenses = [];
                    this.saveExpenses();
                    this.renderExpenses();
                    this.updateStats();
                }
            }
            
            saveExpenses() {
                localStorage.setItem('expenses', JSON.stringify(this.expenses));
            }
            
            renderExpenses() {
                const list = document.getElementById('expenseList');
                const filter = document.getElementById('categoryFilter').value;
                
                let filteredExpenses = this.expenses;
                if (filter) {
                    filteredExpenses = this.expenses.filter(expense => expense.category === filter);
                }
                
                list.innerHTML = filteredExpenses.length === 0 
                    ? '<div class="no-data">ğŸ“ é‚„æ²’æœ‰è¨˜å¸³è¨˜éŒ„</div>'
                    : filteredExpenses.map(expense => this.createExpenseItem(expense)).join('');
            }
            
            createExpenseItem(expense) {
                const isIncome = expense.type === 'income';
                const amountClass = isIncome ? 'income' : 'expense';
                const amountPrefix = isIncome ? '+' : '';
                
                return `
                    <div class="expense-item">
                        <div class="expense-info">
                            <div class="expense-description">${expense.description}</div>
                            <div class="expense-category">${this.getCategoryIcon(expense.category)} ${this.getCategoryName(expense.category)}</div>
                            <div class="expense-date">${new Date(expense.date).toLocaleDateString('zh-TW')}</div>
                        </div>
                        <div class="expense-amount ${amountClass}">
                            ${amountPrefix}$${Math.abs(expense.amount).toFixed(2)}
                        </div>
                        <button class="delete-btn" onclick="expenseTracker.deleteExpense('${expense.id}')">âŒ</button>
                    </div>
                `;
            }
            
            getCategoryIcon(category) {
                const icons = {
                    food: 'ğŸ”',
                    transport: 'ğŸš—',
                    shopping: 'ğŸ›ï¸',
                    entertainment: 'ğŸ®',
                    bills: 'ğŸ’¡',
                    other: 'ğŸ“¦'
                };
                return icons[category] || 'ğŸ“¦';
            }
            
            getCategoryName(category) {
                const names = {
                    food: 'é¤é£²',
                    transport: 'äº¤é€š',
                    shopping: 'è³¼ç‰©',
                    entertainment: 'å¨›æ¨‚',
                    bills: 'å¸³å–®',
                    other: 'å…¶ä»–'
                };
                return names[category] || 'å…¶ä»–';
            }
            
            updateStats() {
                const totalIncome = this.expenses
                    .filter(e => e.type === 'income')
                    .reduce((sum, e) => sum + e.amount, 0);
                
                const totalExpense = this.expenses
                    .filter(e => e.type === 'expense')
                    .reduce((sum, e) => sum + Math.abs(e.amount), 0);
                
                const totalBalance = totalIncome - totalExpense;
                
                document.getElementById('totalBalance').textContent = `$${totalBalance.toFixed(2)}`;
                document.getElementById('totalIncome').textContent = `$${totalIncome.toFixed(2)}`;
                document.getElementById('totalExpense').textContent = `$${totalExpense.toFixed(2)}`;
                document.getElementById('totalRecords').textContent = this.expenses.length;
            }
            
            filterExpenses() {
                this.renderExpenses();
            }
            
            resetForm() {
                document.getElementById('expenseForm').reset();
            }
        }
        
        // åˆå§‹åŒ–æ‡‰ç”¨
        const expenseTracker = new ExpenseTracker();
    </script>
</body>
</html>
